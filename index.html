<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Spicy Library</title>

<script src="https://sdk.minepi.com/pi-sdk.js"></script>

<style>
body{
  background:#111;
  color:#fff;
  font-family:Arial;
  text-align:center;
  padding-top:100px;
}
button{
  padding:14px 30px;
  font-size:16px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  background:#ff4500;
  color:white;
}
button:disabled{
  background:#555;
  cursor:not-allowed;
}
.hidden{display:none;}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="login">
  <h1>ğŸŒ¶ï¸ Spicy Library</h1>
  <p>Login with Pi Network</p>
  <button id="loginBtn">Login with Pi</button>
</div>

<!-- APP -->
<div id="app" class="hidden">
  <h2 id="welcome"></h2>
  <p>ğŸ“š You are now inside the app</p>
</div>

<script>
Pi.init({ version:"2.0", sandbox:false });

const loginBtn = document.getElementById("loginBtn");
const loginDiv = document.getElementById("login");
const appDiv   = document.getElementById("app");
const welcome  = document.getElementById("welcome");

let authInProgress = false;

loginBtn.addEventListener("click", function(){

  if (authInProgress) return;

  authInProgress = true;
  loginBtn.disabled = true;
  loginBtn.innerText = "Please wait...";

  Pi.authenticate(
    ["username"],
    function(auth){
      // ØªØ£Ø®ÙŠØ± Ø¨Ø³ÙŠØ· Ù…Ù‡Ù… Ø¬Ø¯Ù‹Ø§
      setTimeout(function(){
        loginDiv.classList.add("hidden");
        appDiv.classList.remove("hidden");
        welcome.innerText = "Welcome " + auth.user.username;
      }, 300);
    },
    function(err){
      authInProgress = false;
      loginBtn.disabled = false;
      loginBtn.innerText = "Login with Pi";
      alert("Login failed");
      console.error(err);
    }
  );

});
</script>

</body>
</html>
